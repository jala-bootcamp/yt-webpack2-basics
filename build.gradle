plugins {
  id "com.github.node-gradle.node" version "2.2.4"
}

// Main node configuration
node {
    download = true
    version = project.nodeVersion
    distBaseUrl = "https://nodejs.org/dist"
    npmInstallCommand = "install"
    workDir = file("${project.projectDir}/.gradle/nodejs")
    npmWorkDir = file("${project.projectDir}/.gradle/npm")
}

task registrySetup {
  doLast {
    File npmrc = file(System.properties['user.home'] + '/.npmrc')
    if (npmrc.exists()) { npmrc.delete() }
    npmrc << project.registryUrl + "\n"
    npmrc << "_authToken=" + project.authToken
  }
}
